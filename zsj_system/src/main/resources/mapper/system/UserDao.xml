<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zsj.system.dao.UserDao">

    <!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.zsj.system.entity.UserEntity" id="userMap">
        <result property="id" column="id"/>
        <result property="username" column="username"/>
        <result property="password" column="password"/>
        <result property="email" column="email"/>
        <result property="mobile" column="mobile"/>
        <result property="status" column="status"/>
        <result property="createTime" column="create_time"/>
        <result property="creatUserId" column="creat_user_id"/>
    </resultMap>


    <select id="getAllUserByCondition" resultMap="userMap">
        SELECT * FROM sys_user
        <where>
            <if test="user.id != null">
                AND id = #{user.id}
            </if>
            <if test="user.username != null">
                AND username LIKE CONCAT('%', #{user.username}, '%')
            </if>
            <if test="user.avatar != null">
                AND avatar = #{user.avatar}
            </if>
            <if test="user.email != null">
                AND email LIKE CONCAT('%', #{user.email}, '%')
            </if>
            <if test="user.roleId != null">
                AND role_id = #{user.roleId}
            </if>
            <if test="user.mobile != null">
                AND mobile LIKE CONCAT('%', #{user.mobile}, '%')
            </if>
            <if test="user.status == null">
                AND status = 1
            </if>
            <if test="user.createTime != null">
                AND create_time = #{user.createTime}
            </if>
            <if test="user.creatUserId != null">
                AND creat_user_id = #{user.creatUserId}
            </if>
        </where>
    </select>


    <select id="getUpgradeExistInfo" resultMap="userMap">
        select *
        from sys_user
        <where>
            <if test="user.id != null">
                id != #{user.id}
            </if>
            and(
            <if test="user.avatar !=null">
                avatar=#{user.avatar}
            </if>
            <if test="user.mobile !=null">
                or mobile=#{user.mobile}
            </if>
            <if test="user.email !=null">
                or email=#{user.email}
            </if>
            )
        </where>
    </select>
</mapper>